import tkinter
import sqlite3
import tkinter.messagebox

#creating a window
window = tkinter.Tk() #this opens up the window
window.title("Sign-up or Log-in") #this gives the window a name called signup or login

def signUpForm():
    signUpbutton.pack_forget()
    logInbutton.pack_forget()
    frame= tkinter.Frame(window) #creates a frame inside the window
    frame.pack()

    def submit():
        firstNameValue = firstNameEntry.get() #getting the value entered in the first name entry
        if len(firstNameValue)<1 or len(firstNameValue)>20: 
            tkinter.messagebox.showerror(title= "Invalid First Name", message="First name must be between 1 and 20 characters.") #popup error message
            return 

        lastNameValue = lastNameEntry.get() #getting the value entered in the last name entry
        if len(lastNameValue)<1 or len(lastNameValue)>40:
            tkinter.messagebox.showerror(title= "Invalid Last Name", message="Last name must be between 1 and 40 characters.") #popup error message
            return
        
        usernameValue = usernameEntry.get() #getting the value entered in the username entry
        if len(usernameValue)<1 or len(usernameValue)>20:
            tkinter.messagebox.showerror(title= "Invalid Username", message="Username must be between 1 and 20 characters.") #popup error message
            return
        usernameExists = False
        conn = sqlite3.connect('user_data.db') 
        cursor = conn.cursor()
        cursor.execute("SELECT username FROM users WHERE username=?", (usernameValue,)) #checking if the username already exists in the database and if it does then a popup error message will appear
        if cursor.fetchone() is not None:
            usernameExists = True
            tkinter.messagebox.showerror(title= "Invalid Username", message="Username already exists.")
            return
        conn.close()

        passwordValue = passwordEntry.get() #getting the value entered in the password entry
        if len(passwordValue) <8:
            tkinter.messagebox.showerror(title= "Invalid Password", message="Password must be 8 characters or more.") #popup error message
            return
        hasSpecialChar = False 
        for i in range (0, len(passwordValue)): #loop to check that there is a special character in the password
            if passwordValue[i] in "!@#$%^&*-_=+;:,<>?":
                hasSpecialChar = True
        if not hasSpecialChar:
            tkinter.messagebox.showerror(title= "Invalid Password", message="Password must contain at least one special character")
            return
        hasNumber = False
        for i in range (0, len(passwordValue)): #loop to check that there is a number in the password
            if passwordValue[i] == "0" or passwordValue[i] == "1" or passwordValue[i] == "2" or passwordValue[i] == "3" or passwordValue[i] == "4" or passwordValue[i] == "5" or passwordValue[i] == "6" or passwordValue[i] == "7" or passwordValue[i] == "8" or passwordValue[i] == "9":
                hasNumber = True
        if not hasNumber:
            tkinter.messagebox.showerror(title= "Invalid Password", message="Password must contain at least one number")#popup error message
            return
        
        emailValue = emailEntry.get() #getting the value entered in the email entry
        if "@" not in emailValue or "." not in emailValue: #checking that the email contains @ and .
            tkinter.messagebox.showerror(title= "Invalid Email", message="Email must contain @ and . ")
            return
        print("First Name:", firstNameValue)
        print("Last Name:", lastNameValue)
        print("Username:", usernameValue)
        print("Password:", passwordValue)
        print("Email:", emailValue)

        #creating or connecting to a database
        conn = sqlite3.connect('user_data.db')
        userTable_query = '''CREATE TABLE IF NOT EXISTS users (userID INTEGER PRIMARY KEY,first_name TEXT, last_name TEXT, username TEXT, password TEXT, email TEXT) 
        '''
        conn.execute(userTable_query)
        #inserting data into the database
        userTable_query = '''INSERT INTO users (userID,first_name, last_name, username, password, email) VALUES (?, ?, ?, ?, ?, ?)'''
        userTable_tuple = (None, firstNameValue, lastNameValue, usernameValue, passwordValue, emailValue)
        cursor = conn.cursor()
        cursor.execute(userTable_query, userTable_tuple)
        conn.commit()
        conn.close()

        window.destroy() #closes the window after submission


    signUpFrame = tkinter.LabelFrame(frame, text="Personal information") #creates a labelled frame inside the frame
    signUpFrame.grid(row= 0, column=0, padx=20, pady=20) #places the labelled frame at row 0 column 0 of the frame
    signUpFrame2 = tkinter.LabelFrame(frame, text="Account details") #creates a labelled frame inside the frame
    signUpFrame2.grid(row=1, column=0,sticky = "news", padx=20, pady=20) #places the labelled frame at row 1 column 0 of the frame
    signUpFrame3 = tkinter.LabelFrame(frame, text="Email") #creates a labelled frame inside the frame
    signUpFrame3.grid(row=2, column=0,sticky = "news", padx=20, pady=20) #places the labelled frame at row 2 column 0 of the frame

    firstName = tkinter.Label(signUpFrame, text="First name:") #creating the firstname entry
    firstName.config(font = ("ariel",15))
    firstName.grid(row=0, column=0)
    firstNameEntry = tkinter.Entry(signUpFrame)
    firstNameEntry.grid(row=1, column=0)

    lastName = tkinter.Label(signUpFrame, text="Last name:") #creating the lastname entry
    lastName.config(font = ("ariel",15))
    lastName.grid(row=0, column=1)
    lastNameEntry = tkinter.Entry(signUpFrame)
    lastNameEntry.grid(row=1, column=1)

    username = tkinter.Label(signUpFrame2, text="Username:") #creating the username entry
    username.config(font = ("ariel",15))
    username.grid(row=0, column=0)
    usernameEntry = tkinter.Entry(signUpFrame2)
    usernameEntry.grid(row=1, column=0)

    password = tkinter.Label(signUpFrame2, text="Password:") #creating the password entry
    password.config(font = ("ariel",15))
    password.grid(row=0, column=1)
    passwordEntry = tkinter.Entry(signUpFrame2, show="*")
    passwordEntry.grid(row=1, column=1)

    email = tkinter.Label(signUpFrame3, text="Email:") #creating the email entry
    signUpFrame.grid_columnconfigure(0, weight=1)
    email.config(font = ("ariel",15))
    email.grid(row=0, column=0, columnspan=1, sticky="nsew")
    emailEntry = tkinter.Entry(signUpFrame3)
    emailEntry.grid(row=1, column=0, columnspan=1,sticky="nsew")

    submitButton = tkinter.Button(frame, text="Submit", command= submit) #creating the submit button
    submitButton.config(font = ("ariel",15))
    submitButton.grid(row=3 , column=0, sticky="news", padx=20, pady=20)

attemptCount = 0
def checkCredentials(username, password):
    conn = sqlite3.connect('user_data.db') 
    cursor = conn.cursor()
    cursor.execute("SELECT password FROM users WHERE username=?", (username, )) #checking if the username and password match in the database
    fetchedPassword = cursor.fetchone()
    global attemptCount
    if fetchedPassword != (password,):
        attemptCount += 1
        tkinter.messagebox.showerror(title= "Incorrect Credentials", message="Password is incorrect. This is attempt " + str(attemptCount) ) #popup error message
        if attemptCount >= 3:
            tkinter.messagebox.showerror(title= "Too Many Attempts", message="Too many incorrect attempts. Try re-setting password") #popup error message
        return False    
    else:
        conn.close()
        return True

def logInForm():

    signUpbutton.pack_forget()
    logInbutton.pack_forget()

    def submit():
        global usernameValue
        global passwordValue
        usernameValue = usernameEntry.get() #getting the value entered in the username entry
        passwordValue = passwordEntry.get() #getting the value entered in the password entry
        print("Username:", usernameValue)
        print("Password:", passwordValue)
        if verifyLogIn() and checkCredentials(usernameValue, passwordValue):
            window.destroy() #closes the window after submission


    frame= tkinter.Frame(window) #creates a frame inside the window
    frame.pack()

    logInFrame = tkinter.LabelFrame(frame, text="Log-in details") #creates a labelled frame inside the frame
    logInFrame.grid(row= 0, column=0, padx=20, pady=20) #places the labelled frame at row 0 column 0 of the frame
    
    username = tkinter.Label(logInFrame, text="Username:") #creating the username entry
    username.config(font = ("ariel",15))
    username.grid(row=0, column=0)
    usernameEntry = tkinter.Entry(logInFrame)
    usernameEntry.grid(row=0, column=1)

    password = tkinter.Label(logInFrame, text="Password:") #creating the password entry
    password.config(font = ("ariel",15))    
    password.grid(row=1, column=0)
    passwordEntry = tkinter.Entry(logInFrame, show="*")
    passwordEntry.grid(row=1, column=1)

    submitButton = tkinter.Button(frame, text="Submit", command=submit) #creating the submit button
    submitButton.config(font = ("ariel",15))
    submitButton.grid(row=2, column=0, sticky="news", padx=20, pady=20)


def verifyLogIn():
    conn = sqlite3.connect('user_data.db') 
    cursor = conn.cursor()
    cursor.execute("SELECT username FROM users WHERE username=?", (usernameValue,)) #checking if the username exists in the database
    if cursor.fetchone() is None:
        tkinter.messagebox.showerror(title= "Non-existant username", message="Please sign-up as this username does not exist.") #popup error message
        signUpForm()
        return False
    else:
        conn.close()
        return True

 

#creating the sign up and log in buttons
signUpbutton = tkinter.Button(window, text = "Sign-up", command= signUpForm) #creates a button called sign in
signUpbutton.config(font = ("ariel",50),bg = "lightblue",fg = "black") #the sign in button will have the ariel font and size 50
signUpbutton.pack(side="left", expand=True )
   
logInbutton = tkinter.Button(window, text = "Log-in", command = logInForm) #creates a button called log in
logInbutton.config( font = ("ariel",50),bg = "lightgreen",fg = "black") #the log in button will have the ariel font and size 50
logInbutton.pack(side="right", expand=True)   



window.mainloop() #the application window will continue running until x is pressed and the main loop will stop being exectuted#






import tkinter as tk

# ---------- Window ----------
root = tk.Tk()
root.title("Study software")
root.geometry("1000x600")
root.configure(bg="#0b0f14")

# ---------- main Sidebar ----------
sidebar = tk.Frame(root, bg="#0f2a3a", width=80)
sidebar.pack(side="left", fill="y")
# ---------------- Right Sidebar ----------------
rsidebar = tk.Frame(root, bg="#0f2a3a", width=80)
rsidebar.pack(side="right", fill="y", expand=True)

menu_btn = tk.Button(
    rsidebar,
    text="‚â°",
    bg="#0f2a3a",
    fg="#1fa3c7",
    activebackground="#143f56",
    bd=0,
    font=("Arial", 26),
    cursor="hand2"
)
menu_btn.pack()

homeBtnClicked = False
statsBtnClicked = False
physicsBtnClicked = False

def home_clicked():
    global homeBtnClicked
    homeBtnClicked = True
    print("Home clicked") 
    hideForm_physics()
    hideForm_stats()
    showForm_home()


def stats_clicked():
    global statsBtnClicked
    statsBtnClicked = True
    print("Stats clicked")
    hideForm_home()
    hideForm_physics()
    showForm_stats()
    

def physics_clicked():
    global physicsBtnClicked
    physicsBtnClicked = True
    print("Physics clicked")
    hideForm_home()
    hideForm_stats()
    showForm_physics()
    

button_style = {
    "bg": "#0f2a3a",
    "fg": "#1fa3c7",
    "activebackground": "#143f56",
    "activeforeground": "white",
    "bd": 0,
    "font": ("Arial", 20),
    "width": 3,
    "cursor": "hand2"
}

home_btn = tk.Button(sidebar, text="üè†", command=home_clicked, **button_style)
home_btn.pack(pady=30)

stats_btn = tk.Button(sidebar, text="üìä", command=stats_clicked, **button_style)
stats_btn.pack(pady=30)

physics_btn = tk.Button(sidebar, text="üß†", command=physics_clicked, **button_style)
physics_btn.pack(pady=30)

# ---------- Main Content ----------
main = tk.Frame(root, bg="white")
main.pack(side="left", fill="both", expand=True, padx=20, pady=20)

form = tk.Frame(main, bg="white")
form.pack(anchor="nw", pady=30)

# ---------- Form Section ----------
def hideForm_home():
    for child in form.winfo_children():
        child.forget()

def showForm_home():
    def create_row(label_text, value_text):
        row = tk.Frame(form, bg="white")
        row.pack(anchor="w", pady=10)

        label = tk.Label(
            row,
            text=label_text,
            bg="white",
            fg="black",
            font=("Arial", 12),
            width=22,
            anchor="w"
        )
        
        label.pack(side="left")

        entry = tk.Entry(
            row,
            bg="#155e7b",
            fg="black",
            font=("Arial", 12),
            relief="flat",
            width=35
        )
        entry.insert(0, value_text)
        entry.pack(side="left", padx=20, ipady=6)

    create_row("First Name................", "")
    create_row("Surname...................", "")
    create_row("Email.....................", "")

    # ---------- Credentials Box ----------
    credentials = tk.Frame(
        form,
        bg="#155e7b",
        width=600,
        height=200
    )
    credentials.pack(pady=40)
    credentials.pack_propagate(False)

    tk.Label(
        credentials,
        text="Username:",
        bg="#155e7b",
        fg="black",
        font=("Arial", 14),
        pady=20
    ).pack()

    tk.Label(
        credentials,
        text="Password:",
        bg="#155e7b",
        fg="black",
        font=("Arial", 14)
    ).pack()

def hideForm_physics():
    for child in form.winfo_children():
        child.forget()

def showForm_physics():
    # ---------------- Left Sidebar ----------------

    icon_style = {
        "bg": "#0f2a3a",
        "fg": "#1fa3c7",
        "activebackground": "#143f56",
        "bd": 0,
        "font": ("Arial", 20),
        "cursor": "hand2",
        "width": 3
    }

    # ---------------- Main Area ----------------
    main = tk.Frame(form, bg="white")
    main.pack(side="left", fill="both", expand=True)

    # ---------------- Question Header ----------------
    question_header = tk.Frame(
        main,
        bg="#d39ac7",
        height=100,
        highlightbackground="#9b2d91",
        highlightthickness=2
    )
    question_header.pack(fill="x", padx=40, pady=(30, 20), expand=True)
    #pack_propagate() sets whether the frame should adjust its size to fit its contents
    #question_header.pack_propagate(False)
    question_header.pack_propagate(True)

    tk.Label(
        question_header,
        text="Physics question",
        bg="#d39ac7",
        fg="black",
        font=("Arial", 16) ,
        height=2 ,
        width=30 ,
    ).pack(side="left", padx=20, pady=30)

    tk.Label(
        question_header,
        text="Topic, difficulty level",
        bg="#d39ac7",
        fg="black",
        font=("Arial", 14) ,
        height=2 ,
        width=30 ,
    ).pack(side="right", padx=20, pady=30)

    # ---------------- Answer Area ----------------
    answers_box = tk.Frame(
        main,
        bg="#155e7b",
        height=380,
        highlightbackground="black",
        highlightthickness=2
    )
    answers_box.pack(fill="x", padx=40)
    answers_box.pack_propagate(False)

    answers_text = (
        # Placeholder text for physics answers
    )

    tk.Label(
        answers_box,
        text=answers_text,
        bg="#155e7b",
        fg="white",
        font=("Arial", 14),
        justify="left"
    ).pack(pady=40)
    
    

def hideForm_stats():
    for child in form.winfo_children():
        child.forget()

def showForm_stats():
    
    
  
showForm_home()

# ---------- Run ----------
root.mainloop()



